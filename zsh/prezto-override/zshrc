# ------------------------------------------------------------
# Fast exit for non-interactive shells (JetBrains requirement)
# ------------------------------------------------------------
[[ -o interactive ]] || return

# ------------------------------------------------------------
# Custom prompts (must be before Prezto for fpath)
# ------------------------------------------------------------
fpath=("$HOME/.yadr/zsh/prezto-override/prompts" $fpath)

# ------------------------------------------------------------
# Prezto (must be early)
# ------------------------------------------------------------
if [[ -s "$HOME/.zprezto/runcoms/zshrc" ]]; then
  source "$HOME/.zprezto/runcoms/zshrc"
fi

# ------------------------------------------------------------
# YADR customizations
# ------------------------------------------------------------
for config_file in "$HOME/.yadr/zsh/"*.zsh; do
  [[ -r "$config_file" ]] && source "$config_file"
done

# ------------------------------------------------------------
# JetBrains compatibility: re-enable CLOBBER (prezto disables it)
# This allows IntelliJ to redirect output to temp files
# ------------------------------------------------------------
if [[ "$TERMINAL_EMULATOR" == "JetBrains-JediTerm" ]] || [[ -z "$TERM_PROGRAM" ]]; then
  setopt CLOBBER
fi

# ------------------------------------------------------------
# iTerm2 integration (interactive only)
# ------------------------------------------------------------
if [[ "$TERM_PROGRAM" == "iTerm.app" ]] && [[ -s "$HOME/.iterm2_shell_integration.zsh" ]]; then
  source "$HOME/.iterm2_shell_integration.zsh"
fi

# ------------------------------------------------------------
# Colors (do NOT override TERM for JetBrains)
# ------------------------------------------------------------
export CLICOLOR=1
export LS_COLORS='rs=0:di=01;34:ln=01;36:ex=01;32'

# ------------------------------------------------------------
# NVM (lazy + safe)
# ------------------------------------------------------------
export NVM_DIR="$HOME/.nvm"
if [[ -s "$NVM_DIR/nvm.sh" ]]; then
  source "$NVM_DIR/nvm.sh"
fi

# ------------------------------------------------------------
# PATH
# ------------------------------------------------------------
export PATH="$HOME/jetbrains/bin:$PATH"

# ------------------------------------------------------------
# Completions (SINGLE compinit call)
# ------------------------------------------------------------
fpath=(
  "$HOME/.docker/completions"
  "$(brew --prefix 2>/dev/null)/share/zsh-completions"
  $fpath
)

autoload -Uz compinit
compinit -d "$HOME/.zcompdump"

# ------------------------------------------------------------
# Aliases
# ------------------------------------------------------------
alias claude="$HOME/.claude/local/claude"

